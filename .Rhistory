## temperatura promedio
tmean <- raster::getData(name = "worldclim",
var = "tmean",
res = 0.5,
lon = crd[1],
lat = crd[2])
## selecciono solo canta y sus distritos
prov_canta <- shapefile("C:/Users/Usuario/Desktop/5TO CICLO aka COVID/BIOGEOGRAFÍA/TALLER QGIS/QGIS WITH R FERNANDO HERRERA/CANTA_DISTRITOS.shp")
crd <- as.data.frame(coordinates(prov_canta))
plot(prov_canta)
## temperatura promedio
tmean <- raster::getData(name = "worldclim",
var = "tmean",
res = 0.5,
lon = crd[1],
lat = crd[2])
library(tidyverse)
library(sf)
library(sp)
library(raster)
library(rgee)
ee_Initialize()
ee_Initialize("fer")
#descarga división perú dptal
adm <- raster::getData(name = "GADM",
country = "PER",
level = 2)
#descarga división perú dptal
adm <- raster::getData(name = "GADM",
country = "PER",
level = 2)
adm
#descarga división perú dptal
adm <- raster::getData(name = "GADM",
country = "PER",
level = 1)
plot(adm)
#descarga división perú dptal
adm <- raster::getData(name = "GADM",
country = "PER",
level = 2)
plot(adm)
#descarga división perú provincial
adm <- raster::getData(name = "GADM",
country = "PER",
level = 2)
plot(adm)
adm
adm$NAME_2
adm$NAME_2 == "Canta"
adm$NAME_2 == "132"
##CANTA == 132
adm$NAME_2 == "Canta"
##CANTA == 132
View(adm)
##CANTA == 132
##altitud
imagen_dem <- ee$Image("CGIAR/SRTM90_V4")
imagen_dem
##CANTA == 132
##altitud
imagen_srtm <- ee$Image("CGIAR/SRTM90_V4")
imagen_srtm
dem_stack <- ee_as_raster( image = imagen_srtm,
region = area_ee$geometry())
setwd("C:/Users/Usuario/Desktop/20sep")
##dem
dem <- raster("ASTGTM_S12W077_dem.tif")
library(mapview)
adm <- raster::getData(name = "GADM",
country = "PER",
level = 2)
adm
plot(adm)
plot(adm$VARNAME_2="Canta")
plot(adm$VARNAME_2 == "Canta")
adm
getValues(adm)
getvalues(adm)
adm
names(adm)
canta <- adm %>%
filter(adm$NAME_2 == "Canta")
canta
adm
canta <- adm %>%
filter(adm$VARNAME_2 == "Canta")
adm$NAME_0
adm$NAME_1
adm$NAME_2
canta <- adm %>%
filter(adm$NAME_2 == "Canta")
canta <- adm %>%
extract(adm$NAME_2 == "Canta")
canta
canta <- adm %>%
extract(adm$NAME_2 == "Canta")
canta <- adm %>%
raster::extract(adm$NAME_2 == "Canta")
canta <- adm %>%
raster::extract(adm$NAME_2 == "Canta")
canta <- adm %>%
mask(adm$NAME_2 == "Canta")
canta <- adm %>%
mask(adm$NAME_2 == "Canta")
adm$NAME_2 == "Canta"
prov_canta <- adm$NAME_2 == "Canta"
prov_canta
plot(prov_canta)
#cargar shape Canta
st_read("canta_distritos.shp")
#cargar shape Canta
canta_dist <- st_read("canta_distritos.shp")
##dem
dem <- raster("ASTGTM_S12W077_dem.tif")
dem
mapview(list(dem, canta_dist))
mapview(canta_dist)
mapview(list(dem, canta_dist))
canta_dist
#cargar shape Canta
prov <- st_read("Provincias.shp")
mapview(list(dem, prov))
#filtrar canta
prov %>%
filter(PROCOD98 == 1504)
#filtrar canta
canta <- prov %>%
filter(PROCOD98 == 1504)
canta
plot(canta)
plot(st_geometry((canta)
plot(st_geometry((canta))
mapview(list(dem, canta))
dem2 <- raster("ASTGTM_S12W078_dem.tif")
mapview(list(dem1,dem2, canta))
##dem
dem1 <- raster("ASTGTM_S12W077_dem.tif")
dem2 <- raster("ASTGTM_S12W078_dem.tif")
mapview(list(dem1,dem2, canta))
#filtrar canta
canta <- prov %>%
filter(PROCOD98 == 1504)
dem3 <- dem1 + dem2
dem3
mapview(list(dem3, canta))
dem_t <- merge(dem1, dem2)
dem_t
mapview(list(dem_t, canta))
canta
#mapview(list(dem_t, canta))
#mask raster -> as(simple feature, "Spatial)
as(canta, "Spatial)
#mapview(list(dem_t, canta))
#mask raster -> as(simple feature, "Spatial)
sp_canta <- as(canta, "Spatial)
sp_canta
sp_canta
as(canta, "Spatial)
canta
#mapview(list(dem_t, canta))
#mask raster -> as(simple feature, "Spatial)
as(canta, "Spatial")
#mapview(list(dem_t, canta))
#mask raster -> as(simple feature, "Spatial)
sp_canta <- as(canta, "Spatial")
sp_canta
#Unir 2 raster con merge
dem <- merge(dem1, dem2)
extract(dem, sp_canta)
#mapview(list(dem_t, canta))
#mask raster -> as(simple feature, "Spatial)
sp_canta <- as(canta, "Spatial")
extract(dem, sp_canta)
raster::extract(dem, sp_canta)
dem_canta <- raster::extract(dem, sp_canta)
dem_canta
plot(dem_canta)
mask(dem, sp_canta)
canta_dem <- mask(dem, sp_canta)
plot(canta_dem)
canta_mask<- mask(dem, sp_canta)
plot(canta_mask)
crop(dem, sp_canta)
canta_dem <- crop(dem, sp_canta)
plot(canta_dem)
##crop (corte)
canta_crop <- crop(dem, sp_canta)
plot(canta_dem)
plot(canta_crop)
canta_dem <- mask(canta_crop, sp_canta)
plot(canta_dem)
plot(canta_crop)
canta_dem <- mask(canta_crop, sp_canta)
plot(canta_dem)
canta_dem
##altitud media canta
altitud_media <- raster::extract(canta_dem, sp_canta, fun = mean)
altitud_media
##altitud media canta
altitud_media <- raster::extract(canta_dem, sp_canta, fun = mean)
altitud_media
##altitud media canta
altitud_media <- raster::extract(canta_dem, sp_canta, fun = mean)
altitud_media
library(mapedit)
mapview(canta_dem)
mapview(canta_dem) %>%
editMap()
puntos <- mapview(canta_dem) %>%
editMap()
puntos <- mapview(canta_dem) %>%
editMap()
##puntos para canta
puntos <- mapview(canta_dem) %>%
editMap()
puntos_sf <- puntos$all
plot(puntos_sf, add = T)
area
canta
##extrayendo datos con rgee
canta_ee <- sf_as_ee(canta)
ee_ndvi <- ee$ImageCollection("LANDSAT/LC08/C01/T1_8DAY_NDVI")
ee_ndvi <- ee$ImageCollection("LANDSAT/LC08/C01/T1_8DAY_NDVI")$
first()
ee_ndvi <- ee$ImageCollection("LANDSAT/LC08/C01/T1_8DAY_NDVI")$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry())
ndvi_canta <- pp_stack[[1]]
ndvi_canta <- ndvi_stack[[1]]
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry())
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry())
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry(Rectangle))
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry$Rectangle())
##extrayendo datos con rgee
canta_ee <- sf_as_ee(canta)
ee_ndvi <- ee$ImageCollection("LANDSAT/LC08/C01/T1_8DAY_NDVI")$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry())
canta_ee
ee_ndvi <- ee$ImageCollection("LANDSAT/LC08/C01/T1_8DAY_NDVI")$
filterDate('2017-01-01', '2017-12-31')$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry())
canta_ee
canta
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = geometry,
via = "getInfo")
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry,
via = "getInfo")
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry(),
via = "getInfo")
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry())
ndvi_canta <- ndvi_stack[[1]]
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$map())
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$getInfo())
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry$ = Rectangle())
canta
ee_pp <- ee$ImageCollection("ECMWF/ERA5/MONTHLY")$
filterDate("2018-01-01", "2019-01-01")$
first()
pp_stack <- ee_as_raster(imag  = ee_pp,
region = canta_ee$geometry())
pp_area <- pp_stack[[5]]
canta
area
area_sf
canta
canta$geometry
##extrayendo datos con rgee
canta_ee <- sf_as_ee(canta)
ee_ndvi <- ee$ImageCollection("LANDSAT/LC08/C01/T1_8DAY_NDVI")$
filterDate('2017-01-01', '2017-12-31')$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry())
## 1. Crear area mapedit
area <- mapview() %>%
editMap()
area_sf <- area$all
area_sf
mapview(area_sf)
head(area_sf)
area_ee <- sf_as_ee(area_sf)
area_ee
imagen_srtm <- ee$Image("CGIAR/SRTM90_V4")
dem_stack <- ee_as_raster( image = imagen_srtm,
region = area_ee$geometry())
canta
##extrayendo datos con rgee
canta_ee <- sf_as_ee(canta)
ee_ndvi <- ee$ImageCollection("LANDSAT/LC08/C01/T1_8DAY_NDVI")$
filterDate('2017-01-01', '2017-12-31')$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = canta_ee$geometry())
##puntos para canta
area <- mapview(canta_dem) %>%
editMap()
##area relattiva a canta
area <- mapview(canta_dem) %>%
editMap()
##area relattiva a canta
area <- mapview(canta_dem) %>%
editMap()
##area relattiva a canta
area <- mapview(canta_dem) %>%
editMap()
area_sf <- area$all
plot(canta_dem)
plot(area_sf)
mapview(area_sf)
mapview(list(area_sf,dem_canta)
mapview(list(dem_canta,area_sf)
mapview(list(dem_canta, area_sf)
mapview(dem_canta
mapview(list(canta_dem, area_sf))
##extrayendo datos con rgee
area_ee <- sf_as_ee(area)
##extrayendo datos con rgee
area_ee <- sf_as_ee(area_sf)
ee_ndvi <- ee$ImageCollection("LANDSAT/LC08/C01/T1_8DAY_NDVI")$
filterDate('2017-01-01', '2017-12-31')$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
ndvi_canta <- ndvi_stack[[1]]
##extrayendo datos con rgee
area_ee <- sf_as_ee(area_sf)
ee_pop <- ee$ImageCollection("WorldPop/GP/100m/pop")$
first()
pop_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
ndvi_canta <- ndvi_stack[[1]]
ndvi_canta <- pop_stack[[1]]
pop_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
ndvi_canta <- pop_stack[[1]]
ee_pop <- ee$ImageCollection("WorldPop/GP/100m/pop")$
first()
ndvi_stack <- ee_as_raster(imag  = ee_pop,
region = area_ee$geometry())
pop_stack <- ee_as_raster(imag  = ee_pop,
region = area_ee$geometry())
pop_canta <- pop_stack[[1]]
pop_canta
plot(pop_canta)
mapview(list(pop_canta, area_ee))
mapview(list(pop_canta, canta_dem))
##extrayendo datos con rgee
area_ee <- sf_as_ee(area_sf)
ee_ndvi <- ee$ImageCollection("LANDSAT/LC08/C01/T1_8DAY_NDVI")$
filterDate('2017-01-01', '2017-12-31')$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
##extrayendo datos con rgee
area_ee <- sf_as_ee(area_sf)
ee_ndvi <- ee$ImageCollection("CAS/IGSNRR/PML/V2")$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
ndvi_canta <- ndvi_stack[[1]]
plot(ndvi_canta)
plot(ndvi_canta)
ndvi_canta <- ndvi_stack[[1]]
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
ee_ndvi <- ee.Image("CSP/ERGo/1_0/US/lithology")$
first()
ee_ndvi <- ee$Image("CSP/ERGo/1_0/US/lithology")$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
ndvi_canta <- ndvi_stack[[1]]
plot(ndvi_canta)
##extrayendo datos con rgee
area_ee <- sf_as_ee(area_sf)
ee_ndvi <- ee$ImageCollection("IDAHO_EPSCOR/TERRACLIMATE")$
filterDate("2018-01-01", "2019-01-01")$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
ee_ndvi <- ee$ImageCollection('MODIS/006/MOD13Q1')$
filterDate("2018-01-01", "2019-01-01")$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
area_sf <- area$all
plot(area_sf)
mapview(list(canta_dem, area_sf))
ee_ndvi <- ee$ImageCollection('MODIS/006/MOD13Q1')$
filterDate("2018-01-01", "2019-01-01")$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
ee_ndvi <- ee$ImageCollection("IDAHO_EPSCOR/GRIDMET")$
filterDate("2018-01-01", "2019-01-01")$
first()
ndvi_stack <- ee_as_raster(imag  = ee_ndvi,
region = area_ee$geometry())
##pp en metros
ee_pp <- ee$ImageCollection("ECMWF/ERA5/MONTHLY")$
filterDate("2018-01-01", "2019-01-01")$
first()
pp_stack <- ee_as_raster(imag  = ee_pp,
region = area_ee$geometry())
pp_area <- pp_stack[[5]]
plot(pp_area)
mapview(list(pp_area, dem_area))
mapview(list(pp_area, dem_canta))
end
mapview(list(pp_area, canta_dem))
plot(pp_area)
mapview(list(pp_area, canta_dem))
##puntos
puntos <- mapview(canta_dem) %>%
editMap()
puntos_sf <- puntos$all
plot(dem_area)
plot(canta_dem)
plot(puntos_sf, add = T)
plot(canta_dem,
main = "Canta")
plot(puntos_sf, add = T)
plot(canta_dem,
main = "Canta")
plot(puntos_sf, add = T)
#agregando columna de pp
puntos_sf$pp <- raster::extract(pp_area, puntos_sf)
puntos_sf
puntos_sf$Altitud <- raster::extract(canta_dem, puntos_sf)
puntos_sf
#agregando columna de pp
puntos_sf$pp <- raster::extract(pp_area, puntos_sf)
puntos_sf$Altitud <- raster::extract(canta_dem, puntos_sf)
puntos_sf
##surface pressure
presion_area <- pp_stack[[6]]
plot(presion_area)
#agregando columna de pp
puntos_sf$pp <- raster::extract(pp_area, puntos_sf)
puntos_sf$Presión <- raster::extract(presion_area, puntos_sf)
puntos_sf
puntos_sf
##Relacionando elementos climáticos
comparar <- puntos_sf %>%
as_tibble() %>%
dplyr::select(pp, Altitud, Presión)
cor(comparar)
#plot altitud vs surface pressure
plot(comparar$z, comparar$Presión,
main = "Altitude vs Surface Pressure",
ylab = "Surface Pressure(Pa)",
xlab = " Altitude (m)")
#plot altitud vs surface pressure
plot(comparar$Altitud, comparar$Presión,
main = "Altitude vs Surface Pressure",
ylab = "Surface Pressure(Pa)",
xlab = " Altitude (m)")
#plot altitud vs surface pressure
plot(comparar$Altitud, comparar$Presión,
main = "Altitude vs Surface Pressure",
ylab = "Surface Pressure(Pa)",
xlab = " Altitude (m)")
pp_hour <- ee.ImageCollection("JAXA/GPM_L3/GSMaP/v6/operational")$
filterDate("2018-08-06", "2018-08-07")$
first()
pp_hour <- ee$ImageCollection("JAXA/GPM_L3/GSMaP/v6/operational")$
filterDate("2018-08-06", "2018-08-07")$
first()
pp2_stack <- ee_as_raster(imag  = ee_pp,
region = area_ee$geometry())
pp_area_hour <- pp2_stack[[1]]
plot(pp_area_hour)
mapview(list(pp_area_hour, canta_dem))
##Albedo instantáneo
albedo <- ee$ImageCollection("NASA/GLDAS/V021/NOAH/G025/T3H")$
filterDate("2018-08-06", "2018-08-07")$
first()
albedo_stack <- ee_as_raster(imag  = albedo,
region = area_ee$geometry())
albedo_area <- pp2_stack[[1]]
plot(pp_area_hour)
plot(albedo_area)
plot(albedo_area)
albedo_area <- albedo_stack[[1]]
plot(albedo_area)
mapview(list(albedo_area, canta_dem))
plot(albedo_area)
puntos_sf$Albedo(%) <- raster::extract(albedo_area, puntos_sf)
puntos_sf$Albedo <- raster::extract(albedo_area, puntos_sf)
puntos_sf
puntos_sf
comparar <- puntos_sf %>%
as_tibble() %>%
dplyr::select(pp, Altitud, Presión, Albedo)
comparar
